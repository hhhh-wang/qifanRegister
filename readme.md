# 起凡自动注册脚本（含滑动验证码缺口识别）

> ⚠️ **本项目仅用于技术学习、研究与交流，请勿用于任何商业或破坏性用途。**

## 项目简介

这是一个基于 **Python + Windows API** 的起凡游戏平台自动注册脚本示例，完整演示了：

- 自动启动客户端并检测进程
- 基于 **截图 + 模板匹配** 的 UI 自动化操作
- 自动填写注册信息（账号、密码、实名信息等）
- **滑动验证码缺口识别**（基于图像识别）
- 拟人化轨迹模拟的滑块拖动
- 完整日志记录与调试截图机制

整体更偏向于一个 **Windows 自动化 + 图像识别 + 行为模拟** 的综合示例项目。

---

## 功能特性

- ✅ 自动启动起凡游戏平台（支持普通 / 管理员权限）
- ✅ 自动点击登录、注册、同意协议、完成按钮
- ✅ 随机生成账号 / 游戏昵称
- ✅ 自动填写用户名、密码、实名信息
- ✅ 滑动验证码处理
  - 窗口截图
  - 缺口识别
  - 坐标换算（窗口 → 屏幕）
  - 拟人化拖动轨迹
  - 失败刷新与重试机制
- ✅ 失败自动保存调试截图
- ✅ 统一日志系统（文件 + 控制台）

---

## 项目结构

```text
.
├── launch_7fgame.py      # 主入口，自动注册完整流程
├── slide_solver.py      # 滑动验证码处理与缺口识别
├── logger.py             # 日志模块封装
├── pic/                  # UI 模板图片目录
│   ├── login.png
│   ├── tongyi.png
│   ├── wancheng.png
│   ├── huadong_anniu.png
│   └── huadong_shuaxin.png
├── log/                  # 运行日志（自动生成）
└── README.md
```

---

## 运行环境

- 操作系统：**Windows 10 / 11**
- Python：**3.8+**
- 运行方式：
  - Python 直接运行
  - 或 PyInstaller 打包为 exe（已适配）

---

## 依赖库

核心依赖如下：

```bash
pip install pyautogui pillow numpy opencv-python captcha-recognizer pyperclip
```

> ⚠️ `pyautogui` 依赖屏幕分辨率与 DPI 缩放，请确保系统缩放为 **100%**，否则模板匹配会不稳定。

---

## 使用方式

```bash
python launch_7fgame.py
```

可选参数：

```bash
python launch_7fgame.py --wait
```

- `--wait`：主进程阻塞等待客户端退出

---

## 核心实现说明

### 1️⃣ UI 自动化

- 基于 `pyautogui.locateCenterOnScreen`
- 使用模板图片进行定位
- 点击统一走 **WinAPI mouse_event**，避免 pyautogui 偶发失效

### 2️⃣ 输入方式

- 所有文本输入统一走 **剪贴板粘贴**
- 自动绕过中文输入法 / IME 问题

### 3️⃣ 滑动验证码

流程如下：

1. 获取窗口句柄（hwnd）
2. 按窗口坐标截图
3. 使用 `Slider` 模型识别缺口位置
4. 计算缺口在屏幕中的真实坐标
5. 生成拟人化拖动轨迹
6. 模拟加速 → 减速 → 微回拉
7. 失败检测刷新按钮并自动重试

### 4️⃣ 拟人化轨迹

- 非线性加速度
- 随机抖动
- 尾部微回拉

避免「一条直线拖到底」的明显机器特征。

---

## 日志与调试

- 日志路径：`./log/YYYY-MM-DD.log`
- 滑块调试截图：`pic/slide_debug/`
- 每次运行结束会自动清理调试 PNG

---

## 注意事项

- ⚠️ 分辨率、DPI、客户端 UI 更新都会影响识别成功率
- ⚠️ 模板图片需要与你本地客户端完全一致
- ⚠️ 不保证在所有机器、所有版本下稳定运行

---

## 免责声明（重要）

**本项目仅用于：**

- 技术研究
- 自动化测试学习
- 图像识别与行为模拟示例
- Python / WinAPI 编程交流

**作者不对以下行为负责：**

- 利用本项目进行任何形式的商业用途
- 利用本项目批量注册、刷号、绕过平台风控
- 因使用本项目导致的账号封禁、数据损失、法律风险

**请在遵守当地法律法规、平台用户协议的前提下使用本项目。**

> ⚠️ **使用本项目即代表你已理解并自行承担全部风险。**

---

## License

仅供学习与交流使用（Learning & Research Only）

---

如果你对 **Windows 自动化 / 验证码识别 / 行为模拟** 感兴趣，这个项目可以作为一个完整参考示例。